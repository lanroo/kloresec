---
title: "Exploiting Misconfigured Services"
excerpt: "Guide to identifying and exploiting common service misconfigurations during penetration tests"
image: "https://images.unsplash.com/photo-1510915361894-db8b60106cb1?auto=format&fit=crop&q=80"
tags: ["Penetration", "Services", "Security"]
author: "lucas"
date: "2024-01-21"
---

## Introduction

Pentesting internal networks requires a deep understanding of misconfigured services that can be leveraged for access.
Attackers commonly exploit services running with weak authentication or excessive permissions.

## Common Misconfigured Services

Several misconfigured services can be exploited to gain unauthorized network access:

- SMB Shares with sensitive data exposure
- Open RDP (Remote Desktop Protocol) access
- Publicly accessible MySQL/PostgreSQL/MSSQL instances
- Jenkins instances running with admin privileges

## Exploitation Techniques

Pentesters use different techniques to exploit these misconfigurations:

- NTLM Relay Attacks using Responder
- SMB Enumeration with CrackMapExec
- Kerberoasting attacks for credential extraction
- Remote Code Execution (RCE) via exposed Jenkins scripts

Exemplo de código para um scan básico:

\`\`\`python
def port_scan(target):
for port in range(1, 1024):
sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
sock.settimeout(1)
result = sock.connect_ex((target, port))
if result == 0:
print(f"Port {port}: Open")
sock.close()
\`\`\`

## Lateral Movement Strategies

Uma vez dentro da rede interna, os pentesters podem escalar privilégios e se mover lateralmente:

- Pass-the-Hash (PtH) Attacks
- Pivoting using SSH tunnels or ProxyChains
- Extracting credentials from LSASS using Mimikatz
- Leveraging Active Directory misconfigurations

## Mitigation Techniques

Organizations should implement the following measures to protect against these attacks:

1. Restrict SMB and NTLM authentication
2. Regularly audit exposed services and enforce access controls
3. Monitor authentication logs for unusual patterns
4. Harden Active Directory to prevent Kerberoasting and PtH attacks
